define(["backbone","zepto","math","handlebars","lottery","underscore","timer","v-user"],function(B,$,math,handlebar,Lot,_,Timer,User){var View_ssq=B.View.extend({el:"#wrap",initialize:function(){Lot.bet.get_cur_issue({id:220051,ok_call:function(d){d&&!_.isEmpty(d)&&($(".issue").text(d.Issue),$(".countdown").countdown(d.FsEndTime*1e3,function(event){$(this).html(event.strftime('<b class="day red">%D</b>\u5929<b class="hour red">%H</b>\u65f6<b class="minute red">%M</b>\u5206<b class="second red">%S</b>\u79d2'))}))}});var user=new User},events:{"click .random-ball":"fun_dropdown","click .ui.dropdown .button":"fun_dropdown_button","click .ball":"fun_ball","click .add-bet":"fun_add_bet","click .clear-bet":"fun_rm_bet"},fun_dropdown:function(e){var $self=$(e.target);$self.parents(".ui.dropdown").find(".random-num").toggle()},fun_dropdown_button:function(e){var $self=$(e.target),$parent=$self.parents(".random-num"),$top=$parent.parents(".segment"),num=$self.text()*1,type=$parent.attr("type"),max=
$parent.attr("max"),result=math.random({min:1,max:max,size:num,sort:1}),cur_arr=result[0],$item;$top.find(".ball").each(function(index,item){$item=$(item),$.inArray($item.text(),cur_arr)>-1?$item.addClass(type):$item.removeClass(type)}),$top.find(".text").text("\u673a\u9009 "+num+" \u4e2a"),$self.find(".random-num").toggle(),this.count()},fun_ball:function(e){var $self=$(e.target),name="red";$self.parents(".bet-blue-code").length&&(name="blue"),$self.toggleClass(name),this.count()},count:function(){var $wrap=$(this.el),count=math.combo($wrap.find(".ball.red").length,6)*$wrap.find(".ball.blue").length;$wrap.find(".bet-confirm .zhu").text(count),$wrap.find(".bet-confirm .money").text(count*2)},fun_add_bet:function(e){e.preventDefault();var $wrap=$(this.el),red_ball=[];$wrap.find(".ball.red").each(function(index,item){red_ball.push($(item).text())});var blue_ball=[];$wrap.find(".ball.blue").each(function(index,item){blue_ball.push($(item).text())});var data={code:red_ball.join(" ")+"+"+blue_ball
.join(" "),count:math.combo(red_ball.length,6)*blue_ball.length,red:red_ball.join(" "),blue:blue_ball.join(" ")};data.money=data.count*2,data.type=data.count>1?"\u590d\u5f0f":"\u5355\u5f0f";var item=$("#bet-item").html();item=Lot.string.compile(item,data),$("#bet-list").append(item),this.fun_rm_bet()},fun_rm_bet:function(e){e&&e.preventDefault();var $wrap=$(this.el);$wrap.find(".ball").removeClass("red blue"),this.count()}});return View_ssq});